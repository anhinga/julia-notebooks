some joint work done with a friend, who indicated that it's OK to make related code public
